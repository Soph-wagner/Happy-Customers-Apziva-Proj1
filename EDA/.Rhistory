limits = c(0, 100),
label = year2_label,
expand = c(0,0)) +
#customize the theme
theme_minimal() +
theme(plot.margin = margin(20, 40, 20, 40),
text = element_text(family = 'dubois', size=20, lineheight = 0.5),
plot.title = element_text(hjust = 0.5, face = 'bold', margin = margin(0,0,10,0)),
axis.title.x = element_text(hjust = -0.2, vjust = 6.4, size = 5),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank()
) +
labs(title = '4 YEARS OF HIGH SCHOOL OR MORE')
#display plot
bar_plot2
# Now Creating The Plot
bar_plot2 <- ggplot(age25_4yrsHS_df) +
#Vertical bars
geom_bar(aes(x = -perc_4yrsHS_orMore, y = perc_4yrsHS_orMore), stat = 'identity',
width = 0.65, fill = "black") +
#Horizontal black Out
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.7, colour = "black", lineend = "square") +
#Horizontal white inside bars
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.3, colour = "white", lineend = "square") +
#x axis labels
scale_x_continuous(breaks = -perc_4yrsHS_orMore,
limits = c(-100, -70),
expand = c(0,0),
label = label_4yrsHS_orMore,
name = str_wrap("AGE 25 WITH 4 YEARS OF HIGH SCHOOL OR MORE.", 10)) +
#y axis labels
scale_y_continuous(breaks = c(78.5, 81.1, 84.2, 87.0, 90.1),
limits = c(0, 100),
label = year2_label,
expand = c(0,0)) +
#customize the theme
theme_minimal() +
theme(plot.margin = margin(20, 40, 20, 40),
text = element_text(family = 'dubois', size=20, lineheight = 0.5),
plot.title = element_text(hjust = 0.5, face = 'bold', margin = margin(0,0,10,0)),
axis.title.x = element_text(hjust = -0.2, vjust = 6.4, size = 5),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank()
) +
labs(title = '4 YEARS OF HIGH SCHOOL OR MORE')
#display plot
bar_plot2
# Now Creating The Plot
bar_plot2 <- ggplot(age25_4yrsHS_df) +
#Vertical bars
geom_bar(aes(x = -perc_4yrsHS_orMore, y = perc_4yrsHS_orMore), stat = 'identity',
width = 0.65, fill = "black") +
#Horizontal black Out
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.7, colour = "black", lineend = "square") +
#Horizontal white inside bars
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.3, colour = "white", lineend = "square") +
#x axis labels
scale_x_continuous(breaks = -perc_4yrsHS_orMore,
limits = c(-95, -70),
expand = c(0,0),
label = label_4yrsHS_orMore,
name = str_wrap("AGE 25 WITH 4 YEARS OF HIGH SCHOOL OR MORE.", 10)) +
#y axis labels
scale_y_continuous(breaks = c(78.5, 81.1, 84.2, 87.0, 90.1),
limits = c(0, 100),
label = year2_label,
expand = c(0,0)) +
#customize the theme
theme_minimal() +
theme(plot.margin = margin(20, 40, 20, 40),
text = element_text(family = 'dubois', size=20, lineheight = 0.5),
plot.title = element_text(hjust = 0.5, face = 'bold', margin = margin(0,0,10,0)),
axis.title.x = element_text(hjust = -0.2, vjust = 6.4, size = 5),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank()
) +
labs(title = '4 YEARS OF HIGH SCHOOL OR MORE')
#display plot
bar_plot2
# Now Creating The Plot
bar_plot2 <- ggplot(age25_4yrsHS_df) +
#Vertical bars
geom_bar(aes(x = -perc_4yrsHS_orMore, y = perc_4yrsHS_orMore), stat = 'identity',
width = 0.65, fill = "black") +
#Horizontal black Out
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.7, colour = "black", lineend = "square") +
#Horizontal white inside bars
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.3, colour = "white", lineend = "square") +
#x axis labels
scale_x_continuous(breaks = -perc_4yrsHS_orMore,
limits = c(-100, -70),
expand = c(0,0),
label = label_4yrsHS_orMore,
name = str_wrap("AGE 25 WITH 4 YEARS OF HIGH SCHOOL OR MORE.", 10)) +
#y axis labels
scale_y_continuous(breaks = c(78.5, 81.1, 84.2, 87.0, 90.1),
limits = c(0, 100),
label = year2_label,
expand = c(0,0)) +
#customize the theme
theme_minimal() +
theme(plot.margin = margin(20, 40, 20, 40),
text = element_text(family = 'dubois', size=20, lineheight = 0.5),
plot.title = element_text(hjust = 0.5, face = 'bold', margin = margin(0,0,10,0)),
axis.title.x = element_text(hjust = -0.2, vjust = 6.4, size = 5),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank()
) +
labs(title = '4 YEARS OF HIGH SCHOOL OR MORE')
#display plot
bar_plot2
perc_4yrsHS_orMore <- c(78.5, 81.1, 84.2, 87.0, 90.1)
# Now Creating The Plot
bar_plot2 <- ggplot(age25_4yrsHS_df) +
#Vertical bars
geom_bar(aes(x = -perc_4yrsHS_orMore, y = perc_4yrsHS_orMore), stat = 'identity',
width = 0.65, fill = "black") +
#Horizontal black Out
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.7, colour = "black", lineend = "square") +
#Horizontal white inside bars
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.3, colour = "white", lineend = "square") +
#x axis labels
scale_x_continuous(breaks = -perc_4yrsHS_orMore,
limits = c(-100, -70),
expand = c(0,0),
label = label_4yrsHS_orMore,
name = str_wrap("AGE 25 WITH 4 YEARS OF HIGH SCHOOL OR MORE.", 10)) +
#y axis labels
scale_y_continuous(breaks = c(78.5, 81.1, 84.2, 87.0, 90.1),
limits = c(0, 100),
label = year2_label,
expand = c(0,0)) +
#customize the theme
theme_minimal() +
theme(plot.margin = margin(20, 40, 20, 40),
text = element_text(family = 'dubois', size=20, lineheight = 0.5),
plot.title = element_text(hjust = 0.5, face = 'bold', margin = margin(0,0,10,0)),
axis.title.x = element_text(hjust = -0.2, vjust = 6.4, size = 5),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank()
) +
labs(title = '4 YEARS OF HIGH SCHOOL OR MORE')
#display plot
bar_plot2
# Now Creating The Plot
bar_plot2 <- ggplot(age25_4yrsHS_df) +
#Vertical bars
geom_bar(aes(x = -perc_4yrsHS_orMore, y = perc_4yrsHS_orMore), stat = 'identity',
width = 0.65, fill = "black") +
#Horizontal black Out
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.7, colour = "black", lineend = "square") +
#Horizontal white inside bars
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.3, colour = "white", lineend = "square") +
#x axis labels
scale_x_continuous(breaks = -perc_4yrsHS_orMore,
limits = c(-100, -70),
expand = c(0,0),
label = label_4yrsHS_orMore,
name = str_wrap("AGE 25 WITH 4 YEARS OF HIGH SCHOOL OR MORE.", 10)) +
#y axis labels
scale_y_continuous(breaks = c(90.1, 87.0, 84.2, 81.1, 78.5),
limits = c(0, 100),
label = year2_label,
expand = c(0,0)) +
#customize the theme
theme_minimal() +
theme(plot.margin = margin(20, 40, 20, 40),
text = element_text(family = 'dubois', size=20, lineheight = 0.5),
plot.title = element_text(hjust = 0.5, face = 'bold', margin = margin(0,0,10,0)),
axis.title.x = element_text(hjust = -0.2, vjust = 6.4, size = 5),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank()
) +
labs(title = '4 YEARS OF HIGH SCHOOL OR MORE')
#display plot
bar_plot2
# Now Creating The Plot
bar_plot2 <- ggplot(age25_4yrsHS_df) +
#Vertical bars
geom_bar(aes(x = -perc_4yrsHS_orMore, y = perc_4yrsHS_orMore), stat = 'identity',
width = 0.65, fill = "black") +
#Horizontal black Out
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.7, colour = "black", lineend = "square") +
#Horizontal white inside bars
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.3, colour = "white", lineend = "square") +
#x axis labels
scale_x_continuous(breaks = perc_4yrsHS_orMore,
limits = c(-100, -70),
expand = c(0,0),
label = label_4yrsHS_orMore,
name = str_wrap("AGE 25 WITH 4 YEARS OF HIGH SCHOOL OR MORE.", 10)) +
#y axis labels
scale_y_continuous(breaks = c(90.1, 87.0, 84.2, 81.1, 78.5),
limits = c(0, 100),
label = year2_label,
expand = c(0,0)) +
#customize the theme
theme_minimal() +
theme(plot.margin = margin(20, 40, 20, 40),
text = element_text(family = 'dubois', size=20, lineheight = 0.5),
plot.title = element_text(hjust = 0.5, face = 'bold', margin = margin(0,0,10,0)),
axis.title.x = element_text(hjust = -0.2, vjust = 6.4, size = 5),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank()
) +
labs(title = '4 YEARS OF HIGH SCHOOL OR MORE')
#display plot
bar_plot2
# Now Creating The Plot
bar_plot2 <- ggplot(age25_4yrsHS_df) +
#Vertical bars
geom_bar(aes(x = -perc_4yrsHS_orMore, y = perc_4yrsHS_orMore), stat = 'identity',
width = 0.65, fill = "black") +
#Horizontal black Out
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.7, colour = "black", lineend = "square") +
#Horizontal white inside bars
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.3, colour = "white", lineend = "square") +
#x axis labels
scale_x_continuous(breaks = -perc_4yrsHS_orMore,
limits = c(-100, -70),
expand = c(0,0),
label = label_4yrsHS_orMore,
name = str_wrap("AGE 25 WITH 4 YEARS OF HIGH SCHOOL OR MORE.", 10)) +
#y axis labels
scale_y_continuous(breaks = c(90.1, 87.0, 84.2, 81.1, 78.5),
limits = c(0, 100),
label = year2_label,
expand = c(0,0)) +
#customize the theme
theme_minimal() +
theme(plot.margin = margin(20, 40, 20, 40),
text = element_text(family = 'dubois', size=20, lineheight = 0.5),
plot.title = element_text(hjust = 0.5, face = 'bold', margin = margin(0,0,10,0)),
axis.title.x = element_text(hjust = -0.2, vjust = 6.4, size = 5),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank()
) +
labs(title = '4 YEARS OF HIGH SCHOOL OR MORE')
#display plot
bar_plot2
# Now Creating The Plot
bar_plot2 <- ggplot(age25_4yrsHS_df) +
#Vertical bars
geom_bar(aes(x = -perc_4yrsHS_orMore, y = perc_4yrsHS_orMore), stat = 'identity',
width = 0.65, fill = "black") +
#Horizontal black Out
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.7, colour = "black", lineend = "square") +
#Horizontal white inside bars
geom_segment(aes(x = m_pct, y = perc_4yrsHS_orMore, xend = xend, yend = perc_4yrsHS_orMore),
stat = "identity", size = 2.3, colour = "white", lineend = "square") +
#x axis labels
scale_x_continuous(breaks = -perc_4yrsHS_orMore,
limits = c(-100, -70),
expand = c(0,0),
label = label_4yrsHS_orMore,
name = str_wrap("AGE 25 WITH 4 YEARS OF HIGH SCHOOL OR MORE.", 10)) +
#y axis labels
scale_y_continuous(breaks = c(78.5, 81.1, 84.2, 87.0, 90.1),
limits = c(0, 100),
label = year2_label,
expand = c(0,0)) +
#customize the theme
theme_minimal() +
theme(plot.margin = margin(20, 40, 20, 40),
text = element_text(family = 'dubois', size=20, lineheight = 0.5),
plot.title = element_text(hjust = 0.5, face = 'bold', margin = margin(0,0,10,0)),
axis.title.x = element_text(hjust = -0.2, vjust = 6.4, size = 5),
panel.background = element_blank(),
panel.grid = element_blank(),
axis.title.y = element_blank(),
axis.ticks = element_blank()
) +
labs(title = '4 YEARS OF HIGH SCHOOL OR MORE')
#display plot
bar_plot2
### Load Packages !
library(tidyverse)
library(ggthemes)
library(waffle)
library(ggplot2)
library(patchwork)
library(dplyr)
library(ggthemes)
# set theme for ggplot2
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 16))
# set figure parameters for knitr
knitr::opts_chunk$set(
fig.width = 7, # 7" width
fig.asp = 0.618, # the golden ratio
fig.retina = 3, # dpi multiplier for displaying HTML output on retina
fig.align = "center", # center align figures
dpi = 300 # higher dpi, sharper image
)
### Loading in Data !!
survey <- read.csv("ACME-HappinessSurvey2020.csv")
setwd("G:/My Drive/Apziva_Program/Projects/Project1_HappyCustomers/J8bYWsXvIvl1veY4-main")
### Loading in Data !!
survey <- read.csv("ACME-HappinessSurvey2020.csv")
glimpse(survey)
question_code <- c("My Order Was Delivered On Time", "Contents Of My Order Was As I Expected",
"I Ordered Everything I Wanted To Order", "I Paid A Good Price For My Order",
"I Am Satisfied With My Courier", "The App Makes Ordering Easy For Me")
#response_code <- c("Very Dissatisfied", "Dissatisfied", "Neutral", "Satisfied", "Very Satisfied")
response_code <- c("Very Satisfied", "Satisfied", "Neutral", "Dissatisfied", "Very Dissatisfied")
sat_colr <- if_else(survey$Y == 1, "darkblue", "yellow") #darkblue is Happy, Yellow is Unhappy
y_code <- c("Happy", "Unhappy")
y_colr <- c("darkblue", "yellow")
#### GRAPH 1 ####
# attempting to make a COUNT waffle chart for X1
w1 <- survey |>
count(X1) |>
ggplot(aes(fill = X1, values = n)) +
geom_waffle(n_rows = 10, size = 1, color = sat_colr) +
scale_fill_tableau() +
labs(fill = question_code[1]) +
theme_enhance_waffle() +
theme(legend.position = "top")
# COUNT waffle chart for X2
w2 <- survey |>
count(X2) |>
ggplot(aes(fill = X2, values = n)) +
geom_waffle(n_rows = 10, size = 1, color = sat_colr) +
scale_fill_tableau() +
labs(fill = question_code[2]) +
theme_enhance_waffle() +
theme(legend.position = "top")
# COUNT waffle chart for X3
w3 <- survey |>
count(X3) |>
ggplot(aes(fill = X3, values = n)) +
geom_waffle(n_rows = 10, size = 1, color = sat_colr) +
scale_fill_tableau() +
labs(fill = question_code[3]) +
theme_enhance_waffle() +
theme(legend.position = "top")
# COUNT waffle chart for X4
w4 <- survey |>
count(X4) |>
ggplot(aes(fill = X4, values = n)) +
geom_waffle(n_rows = 10, size = 1, color = sat_colr) +
scale_fill_tableau() +
labs(fill = question_code[4]) +
theme_enhance_waffle() +
theme(legend.position = "top")
# COUNT waffle chart for X5
w5 <- survey |>
count(X5) |>
ggplot(aes(fill = X5, values = n)) +
geom_waffle(n_rows = 10, size = 1, color = sat_colr) +
scale_fill_tableau() +
labs(fill = question_code[5]) +
theme_enhance_waffle() +
theme(legend.position = "top")
# COUNT waffle chart for X6
w6 <- survey |>
count(X6) |>
ggplot(aes(fill = X6, values = n)) +
geom_waffle(n_rows = 10, size = 1, color = sat_colr) +
scale_fill_tableau() +
labs(fill = question_code[6]) +
theme_enhance_waffle() +
theme(legend.position = "top")
#Finally displaying all waffle charts
w1 + w2 + w3
w4 + w5 + w6
#### GRAPH 2 ####
# bar chart for X1 colored by Y category
p1 <- ggplot(survey, aes(x = X1, fill = sat_colr)) +
geom_bar(stat = "count", position = position_dodge(width = 1),
color = "white", width = 1) +
labs(title = question_code[1],
x = "Response", y = "Count",
fill = "Happy Rating") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 8),
#places the title inside the plot panel
plot.title.position = "plot",
#removes the minor grid lines on the x axis !
panel.grid.minor.x = element_blank(),
plot.margin = unit(c(1, 1, 2, 1), "cm")) +
scale_fill_manual(values = y_colr, labels = c(y_code))
# bar chart for X2 colored by Y category
p2 <- ggplot(survey, aes(x = X2, fill = sat_colr)) +
geom_bar(stat = "count", position = position_dodge(width = 1),
color = "white", width = 1) +
labs(title = question_code[2],
x = "Response", y = "Count",
fill = "Happy Rating") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 8),
#places the title inside the plot panel
plot.title.position = "plot",
#removes the minor grid lines on the x axis !
panel.grid.minor.x = element_blank(),
plot.margin = unit(c(1, 1, 2, 1), "cm")) +
scale_fill_manual(values = y_colr, labels = c(y_code))
# bar chart for X3 colored by Y category
p3 <- ggplot(survey, aes(x = X3, fill = sat_colr)) +
geom_bar(stat = "count", position = position_dodge(width = 1),
color = "white", width = 1) +
labs(title = question_code[3],
x = "Response", y = "Count",
fill = "Happy Rating") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 8),
#places the title inside the plot panel
plot.title.position = "plot",
#removes the minor grid lines on the x axis !
panel.grid.minor.x = element_blank(),
plot.margin = unit(c(1, 1, 2, 1), "cm")) +
scale_fill_manual(values = y_colr, labels = c(y_code))
# bar chart for X4 colored by Y category
p4 <- ggplot(survey, aes(x = X4, fill = sat_colr)) +
geom_bar(stat = "count", position = position_dodge(width = 1),
color = "white", width = 1) +
labs(title = question_code[4],
x = "Response", y = "Count",
fill = "Happy Rating") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 8),
#places the title inside the plot panel
plot.title.position = "plot",
#removes the minor grid lines on the x axis !
panel.grid.minor.x = element_blank(),
plot.margin = unit(c(1, 1, 2, 1), "cm")) +
scale_fill_manual(values = y_colr, labels = c(y_code))
# bar chart for X5 colored by Y category
p5 <- ggplot(survey, aes(x = X5, fill = sat_colr)) +
geom_bar(stat = "count", position = position_dodge(width = 1),
color = "white", width = 1) +
labs(title = question_code[5],
x = "Response", y = "Count",
fill = "Happy Rating") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 8),
#places the title inside the plot panel
plot.title.position = "plot",
#removes the minor grid lines on the x axis !
panel.grid.minor.x = element_blank(),
plot.margin = unit(c(1, 1, 2, 1), "cm")) +
scale_fill_manual(values = y_colr, labels = c(y_code))
# bar chart for X6 colored by Y category
p6 <- ggplot(survey, aes(x = X6, fill = sat_colr)) +
geom_bar(stat = "count", position = position_dodge(width = 1),
color = "white", width = 1) +
labs(title = question_code[6],
x = "Response", y = "Count",
fill = "Happy Rating") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 8),
#places the title inside the plot panel
plot.title.position = "plot",
#removes the minor grid lines on the x axis !
panel.grid.minor.x = element_blank(),
plot.margin = unit(c(1, 1, 2, 1), "cm")) +
scale_fill_manual(values = y_colr, labels = c(y_code))
# Finally displaying all bar plots
p1 + p2 + p3 + p4 + p5+ p6
#### GRAPH 2 ####
# creating a colored horizontal chart for Likert data
survey |>
select(contains("X")) |>
glimpse()
survey |>
select(contains("X")) |>
pivot_longer(
cols = everything(),
names_to =  "question",
values_to = "response",
values_transform = as.character) |>
ggplot(aes(y = question)) +
geom_bar(aes(fill = fct_rev(response))) +
#geom_bar(aes(fill = response)) +
scale_fill_viridis_d(na.value = "gray", labels = c(response_code)) +
scale_y_discrete(labels = c(question_code), expand = c(0.1, 0)) +
labs(
title = "Overall Quality of Services",
fill = "Response",
y = "Question",
x = "Count"
)
